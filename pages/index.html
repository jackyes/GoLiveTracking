
<html>
<head>
  <title>Live Tracking</title>
  <link rel="stylesheet" href="./static/leaflet.css"/>
  <script src="./static/leaflet.js"></script>
  <style>
    #map{ height: 100% }
  </style>
  <meta http-equiv="refresh" content="{{.MapRefreshTime}}">
</head>
<body>

  <div id="map"></div>

  <script>

  // initialize the map
  var map = L.map('map').setView([{{.DefaultLat}}, {{.DefaultLon}}], {{.DefaultZoom}});
  L.control.scale().addTo(map)
  map.options.minZoom = {{.MinZoom}};
  map.options.maxZoom = {{.MaxZoom}};
  // load a tile layer
  const basemaps = {
  OpenStreetMap: L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors', subdomains: ['a','b','c']}),
  OpenTopoMap: L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {maxZoom: 20, attribution: 'Map data: &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)', subdomains: ['a','b','c']}),
  GoogleStreets: L.tileLayer('http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}',{attribution: '&copy; GoogleMap', maxZoom: 20, subdomains:['mt0','mt1','mt2','mt3']}),
  GoogleHybrid: L.tileLayer('http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}',{attribution: '&copy; GoogleMap', maxZoom: 20, subdomains:['mt0','mt1','mt2','mt3']}),
  GoogleSat: L.tileLayer('http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}',{attribution: '&copy; GoogleMap', maxZoom: 20, subdomains:['mt0','mt1','mt2','mt3']}),
  GoogleTerrain: L.tileLayer('http://{s}.google.com/vt/lyrs=p&x={x}&y={y}&z={z}',{attribution: '&copy; GoogleMap', maxZoom: 20, subdomains:['mt0','mt1','mt2','mt3']}),
};

var overlay = {
	HikingTrails: L.tileLayer('https://tile.waymarkedtrails.org/{id}/{z}/{x}/{y}.png',{id: 'hiking', attribution: '&copy; <a href="http://waymarkedtrails.org">Sarah Hoffmann</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'}),
	CyclingTrails: L.tileLayer('https://tile.waymarkedtrails.org/{id}/{z}/{x}/{y}.png',{id: 'cycling', attribution: '&copy; <a href="http://waymarkedtrails.org">Sarah Hoffmann</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'}),
};
  
L.control.layers(basemaps, overlay).addTo(map);
basemaps.OpenStreetMap.addTo(map);

{{if .ShowOnlyLastPos}}{{else}}
var latlngs = [ 
{{range .Latlonhistory}}  [{{.}}],
{{end}}
];

var polyline = L.polyline(latlngs, {color: 'red'}).addTo(map);
// zoom the map to the polyline
map.fitBounds(polyline.getBounds());
{{end}}
{{.Lastpos}}

  </script>
  
</body>
</html>
